# Correction Report Schema

**Version:** 1.0.0
**Last Updated:** 2025-01-20
**Used by:** `/proof`, `/fact-check`, correction-workflow guide

Standard schema for correction reports generated by proofreading and fact-checking commands.

---

## Report Structure

### Header

```markdown
## [Report Type] Report: [Document Name]

**Source:** [command name]
**Generated:** [timestamp]
**Target:** [file path]
**Editable:** Yes/No
```

### Summary Section

```markdown
### Summary

| Category | Count |
|----------|-------|
| Errors | X |
| Warnings | X |
| Suggestions | X |
```

---

## Correction Item Schema

Each correction follows this format:

```markdown
#### [N] Short description of the issue

- **Location:** `path/to/file.md:line`
- **Severity:** Error | Warning | Suggestion
- **Context (before):**
  ```

  [2-3 lines of surrounding text including the issue]

  ```
- **Suggested fix:**
  ```

  [Same context with the correction applied]

  ```
- **Rationale:** [Why this change is needed]
```

### Field Definitions

| Field | Required | Description |
|-------|----------|-------------|
| **[N] Description** | Yes | Numbered item with brief description of the issue |
| **Location** | Yes | File path and line number in format `path:line` |
| **Severity** | Yes | One of: `Error`, `Warning`, `Suggestion` |
| **Context (before)** | Yes | 2-3 lines surrounding the issue for unique matching |
| **Suggested fix** | Yes | Same context with the correction applied |
| **Rationale** | Yes | Explanation of why the change is needed |

### Optional Fields (Command-Specific)

Commands may add additional fields as needed:

| Field | Used By | Description |
|-------|---------|-------------|
| **Category** | `/fact-check` | Claim type: Statistic, Citation, Study Finding, etc. |
| **Source** | `/fact-check` | Original source citation for verification |
| **Confidence** | `/fact-check` | Verification confidence: High, Medium, Low |
| **Issue** | `/fact-check` | Detailed description of the discrepancy |

---

## Severity Levels

| Level | Definition | Action |
|-------|------------|--------|
| **Error** | Factual error, broken functionality, or critical issue | Must fix |
| **Warning** | Potential problem, inconsistency, or style violation | Should fix |
| **Suggestion** | Optional improvement or enhancement | Consider fixing |

---

## Example: Proofreading Correction

```markdown
#### [1] Typo: "teh" should be "the"

- **Location:** `chapters/intro.md:42`
- **Severity:** Error
- **Context (before):**
  ```

  This is teh example
  text that needs fixing.

  ```
- **Suggested fix:**
  ```

  This is the example
  text that needs fixing.

  ```
- **Rationale:** Spelling error
```

---

## Example: Fact-Check Correction

```markdown
#### [1] Incorrect statistic: 39% should be 36%

- **Location:** `chapters/results.md:89`
- **Severity:** Error
- **Category:** Statistic
- **Context (before):**
  ```

  The error rate was 39% higher than
  the control group.

  ```
- **Suggested fix:**
  ```

  The error rate was 36% higher than
  the control group.

  ```
- **Rationale:** Source data shows 36%, not 39%
- **Source:** Smith et al. (2023), Table 2
- **Confidence:** High
```

---

## Non-Auto-Fixable Items

Items that cannot be automatically fixed should be listed separately:

```markdown
### Items Not Auto-Fixable

| Line | Issue | Reason |
|------|-------|--------|
| 156 | Unclear reference | Requires author decision |
| 203 | Missing citation | Source unknown |
```

---

## Apply Logic

When applying corrections programmatically:

1. **Apply bottom-to-top** (highest line numbers first) to preserve line numbers
2. **Match context exactly** using the "Context (before)" text
3. **Skip if already correct** (context matches suggested fix)
4. **Log results** for each correction: Applied, Skipped, Failed

See [correction-workflow](../guides/correction-workflow.md) for the complete apply workflow.

---

## Version History

### 1.0.0 (2025-01-20)

- Initial release
- Consolidated schema from proof.md, fact-check.md, and correction-workflow.md
